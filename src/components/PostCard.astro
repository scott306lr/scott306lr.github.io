---
import type { CollectionEntry } from 'astro:content';
import { formatYmd } from '../lib/dates';

type Props = {
	post: CollectionEntry<'posts'>;
	compact?: boolean;
	filterText?: string;
};

const { post, compact = false, filterText } = Astro.props;
---

<article
	class:list={[
		'relative rounded-lg border bg-card p-4 transition hover:bg-accent',
		compact ? 'p-3' : null,
	]}
	{...(filterText ? { 'data-filter-text': filterText } : {})}
>
	<a href={`/posts/${post.slug}`} class="block no-underline">
		<div class="flex items-baseline justify-between gap-4">
			<span class="font-medium text-card-foreground">{post.data.title}</span>
			<span class="text-xs text-muted-foreground">{formatYmd(post.data.pubDate)}</span>
		</div>
		{post.data.description ? <p class="mt-2 text-sm text-muted-foreground">{post.data.description}</p> : null}
	</a>

	{post.data.tags?.length ? (
		<div class="mt-3 flex flex-wrap gap-1.5">
			{post.data.tags.map((t) => (
				<a
					href={`/tags/${String(t).trim().toLowerCase()}`}
					class="rounded-full border border-border bg-muted px-2 py-0.5 text-xs text-muted-foreground no-underline hover:text-foreground"
				>
					{t}
				</a>
			))}
		</div>
	) : null}
</article>
