---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { isNotDraft, sortByDateDesc } from '../lib/content';
import { formatYmd } from '../lib/dates';

const posts = (await getCollection('posts')).filter(isNotDraft).sort(sortByDateDesc).slice(0, 6);
const works = (await getCollection('works'))
	.filter(isNotDraft)
	.filter((w) => w.data.featured)
	.sort(sortByDateDesc)
	.slice(0, 6);
---

<BaseLayout
	title="Scott — Blog & Works"
	description="Works and thoughts by Scott."
>
	<section class="mb-12">
		<h1 class="text-3xl font-bold tracking-tight">Hi, I’m Scott.</h1>
		<p class="mt-3 max-w-prose text-zinc-600 dark:text-zinc-300">
			I post my works and thoughts here. The site is intentionally minimal: fast, readable, and built for developers.
		</p>
	</section>

	<section class="mb-12">
		<div class="mb-4 flex items-baseline justify-between">
			<h2 class="text-xl font-semibold">Latest posts</h2>
			<a href="/posts" class="text-sm no-underline hover:underline">All posts</a>
		</div>
		<ul class="space-y-3">
			{posts.map((post) => (
				<li>
					<a href={`/posts/${post.slug}`} class="no-underline hover:underline">
						<span class="font-medium">{post.data.title}</span>
					</a>
					<div class="text-sm text-zinc-500 dark:text-zinc-400">
						{formatYmd(post.data.pubDate)} · {post.data.description}
					</div>
				</li>
			))}
		</ul>
	</section>

	<section>
		<div class="mb-4 flex items-baseline justify-between">
			<h2 class="text-xl font-semibold">Featured works</h2>
			<a href="/works" class="text-sm no-underline hover:underline">All works</a>
		</div>
		<ul class="space-y-3">
			{works.map((work) => (
				<li>
					<a href={`/works/${work.slug}`} class="no-underline hover:underline">
						<span class="font-medium">{work.data.title}</span>
					</a>
					<div class="text-sm text-zinc-500 dark:text-zinc-400">{work.data.summary}</div>
				</li>
			))}
		</ul>
	</section>
</BaseLayout>
